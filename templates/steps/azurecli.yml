parameters:
  - name: displayName
    type: string
    default: Azure CLI
  - name: azureSubscription
    type: string
    default: ""
  - name: repoAlias
    type: string
    default: PipelineCommon
  - name: script
    type: string
    default: ""
  - name: scriptFullPath
    type: string
    default: ""
  - name: arguments
    type: string
    default: ""
  - name: workingDirectory
    type: string
    default: ""
  - name: condition
    type: string
    default: ""
  - name: addSpnToEnvironment
    type: boolean
    default: false

steps:
  - task: AzureCLI@2
    displayName: ${{ parameters.displayName }}
    inputs:
      scriptType: pscore
      scriptLocation: scriptPath
      ${{ if ne(parameters.scriptFullPath, '') }}:
        scriptPath: ${{ parameters.scriptFullPath }}
      ${{ if and(eq(parameters.scriptFullPath, ''), ne(parameters.script, '')) }}:
        scriptPath: $(Pipeline.Workspace)/s/${{ parameters.repoAlias }}/scripts/${{ parameters.script }}
      ${{ if ne(parameters.arguments, '') }}:
        arguments: ${{ parameters.arguments }}
      ${{ if ne(parameters.workingDirectory, '') }}:
        workingDirectory: ${{ parameters.workingDirectory }}
      ${{ if ne(parameters.azureSubscription, '') }}:
        azureSubscription: ${{ parameters.azureSubscription }}
      ${{ if and(eq(parameters.addSpnToEnvironment, true), ne(parameters.azureSubscription, '')) }}:
        addSpnToEnvironment: true
    ${{ if ne(parameters.condition, '') }}:
      condition: ${{ parameters.condition }}
