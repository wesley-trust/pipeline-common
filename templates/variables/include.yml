# Compile-time variable inclusion, controlled by include flags so missing files can be safely omitted.
# Parameters:
# - variableRoot: root folder for variables (default 'vars')
# - environmentName: env name (e.g., dev)
# - regionName: region code (optional)

parameters:
  - name: variableRoot
    type: string
    default: "vars"
  - name: environmentName
    type: string
    default: ""
  - name: regionName
    type: string
    default: ""
  - name: includeCommon
    type: boolean
    default: true
  - name: includeRegionOnly
    type: boolean
    default: true
  - name: includeEnv
    type: boolean
    default: true
  - name: includeEnvRegion
    type: boolean
    default: true

variables:
  # 1) Common/shared variables
  - ${{ if eq(parameters.includeCommon, true) }}:
      - template: ${{ format('{0}/common.yml', parameters.variableRoot) }}

  # 2) Region-only variables (applies across all environments)
  - ${{ if and(eq(parameters.includeRegionOnly, true), ne(parameters.regionName, '')) }}:
      - template: ${{ format('{0}/region/{1}.yml', parameters.variableRoot, parameters.regionName) }}

  # 3) Per-environment variables
  - ${{ if and(eq(parameters.includeEnv, true), ne(parameters.environmentName, '')) }}:
      - template: ${{ format('{0}/env/{1}.yml', parameters.variableRoot, parameters.environmentName) }}

  # 4) Per-environment per-region variables
  - ${{ if and(eq(parameters.includeEnvRegion, true), ne(parameters.environmentName, ''), ne(parameters.regionName, '')) }}:
      - template: ${{ format('{0}/{1}/region/{2}.yml', parameters.variableRoot, parameters.environmentName, parameters.regionName) }}
